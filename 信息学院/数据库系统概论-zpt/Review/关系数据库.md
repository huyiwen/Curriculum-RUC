[TOC]
# 关系数据库
## 概念
- 基数：域中不同取值的个数
- 笛卡尔积的基数为各因式基数之积
- 关系：$D_1 \times D_2 \dots \times D_n$的子集
  - n为目、度
  - 关系的每一行是一个元组、每一列是一个域，为了区别不同的而域，将其称为属性
  - **候选码**：若关系的某一属性组的值能唯一的标识一个元组，而其子集不能，则将该属性组成为候选码
    - 若一个关系有多个候选码，则选定其中一个作为主码
    - 候选码的诸属性成为主属性，不包含在候选码中的属性成为非主属性（非码属性）
    - 全码：关系的所有属性都是这个关系的候选码
- 关系类型：
  - 基本关系
  - 查询表
  - 视图表
    - 由别的表导出的表，是虚表
- 关系模式
  - $R(U,D,DOM,\mathcal{F})$
    - U:属性集合
    - D:域的集合
    - DOM:属性对应域的集合
  - 关系模式是静态的，关系是动态的
- 关系操作
  - 查询
    - **选择**
    - **投影**
    - **笛卡尔积**
    - **并**
    - **差**
    - 除
    - 连接
    - 交
  - 插入
  - 删除
  - 修改
- 关系的完整性
  - **实体完整性**
    - 关系R的主属性（主码）A不能取空值
  - **参照完整性**
    - 若关系R的外码F对应关系S的码$K_s$，则R的每一个元组中F的值要么为空，要么为某一个$K_S$的值
  - 用户定义的完整性
    - 用户定义的约束条件
    - 如60岁后要退休



## 概念辨析
### 主码, 候选码, 主属性, 非主属性
- **候选码**: 一个**属性组**, 能够唯一地标志出一个元组, 而其子集不能
- **主码**: 如果关系有多个(**组**)候选码, 选其中一个(组)作为主码
- **主属性**: 候选码中的属性
- **非主属性**: 不包含在任何候选码中的属性
- **外码**: 关系$R$的某一**非主$F$属性**引用了关系$S$的主属性$K_s$，那么$R$为参照（referencing）关系，$S$为被参照（referenced）关系或目标关系，称**F为R的外码**

## 关系代数
- 操作对象和结果都是**集合**
### 简单的
  - 传统集合运算
    - 并$\cup$
    - 交$\cap$
    - 差$-$
    - 笛卡尔积$\times$

  - 专门的关系运算
    - 选择$\sigma$
      - $\sigma_{F}(R)=\{t|t\in R \wedge F(t) = True\}$
    - 投影$\sqcap$
      - $\sqcap_A(R) = \{t[A]|t \in R\}$

### 连接
- 自然连接
  - 不用写连接条件, 默认在**同名属性**上做连接, 并且结果去除同名列
- 外连接
  - 不满足连接条件的元组也保留在结果里, 没有连接到的**补空**
  - 左外连接
    - 保存左边关系所有的元组
  - 右外连接
### 除法
#### 象集
- $R(X,Y)$上$X=x$的象集$P$为:$$P_x = \sqcap_Y(\sigma_{X=x}(R))$$
#### 除
- $R(X,Y)\div S(Y,Z)$
  - 结果是一个新的关系$P\subseteq R$
  - 记$X=x$的象集为$U_x$, 则$$P = \{\sqcap_X\sigma_{X=x}(R)\mid \sqcap_Y(R)\subseteq U_x\}\Leftrightarrow \sqcap_X(R) - \sqcap_X(\sqcap_X(R)\times \sqcap_Y(S) - R)$$