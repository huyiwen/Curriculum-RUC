[TOC]
# 处理机
## 控制信号
### 控制器的组成
- 程序计数器PC
- 指令寄存器IR
- 指令译码器
- 脉冲源
  - 产生激活寄存器的脉冲
- 时序控制信号形成部件
  - 产生中断的时钟信号

### 各种周期
- **机器周期**: 执行一项基本操作所需要的时间
  - 用延迟最长的存储器操作的时间作为该周期
  - 一个指令包含不同数量的机器周期
- **时钟周期**: 时钟脉冲(*频率*)的倒数, 是 **计算机中最基本的时间单位, 即完成一个基本操作的时间**
  - 时钟频率越高, 计算机的工作速度越快
- **状态周期**
- **指令周期**: 执行一条指令所需要的时间
- **主时钟(脉冲)**: 由晶体振荡器产生的吧
  - 经过2分频形成T, 经过4分频形成C
  - 经过组合电路形成尖尖脉冲
  - 尖尖脉冲可以用来做下一级的激活
### 总线
- **AR**: 数据地址总线, 传输数据的**地址**
- **DR**: 数据总线, 传输地址单元中的**数据**
### 各种寄存器
- **IR**: 当前执行的指令内容
- **PC**: 当前/下一条执行指令的地址
- **rs/rd**: 用来指代同一个寄存器
- **rs1**: 另一个寄存器

### 各种信号: 其实就是各种开关
- **电平信号**: 保持一段长时间的信号输出, 保证ALU的输入, 输出信号保持足够长的时间, **让ALU计算？**
- **脉冲信号**: 保证计算输出的结果能够可靠的保存到某个寄存器中, **让ALU输出计算结果到GR/AR/PC中**

### 各种微操作
#### 取指操作
  - $PC\rightarrow AB$
  - $W/R = 0$
  - $M/IO = 1$
  - $DB\rightarrow IR$
  - $PC+(1)$
#### 准备地址
  - 将$[r_j + disp]$这种东西解析出来, **一个机器周期**
  - $r_j\rightarrow GR$
    - 将IR中保存的指令的$r_j$的**编号**输送到`GR`, 供其**译码**
  - $[r_j]\rightarrow ALU$
    - 将$r_j$中的数据从**IN1**传输到`ALU`, 供其计算
  - $disp\rightarrow ALU$
    - 将IR中保存的指令的$disp$(**立即数**)从`IN2`传输到`ALU`, 供其计算
  - $+\rightarrow ALU$
    - 计算$r_j$和$disp$两者的和(基址相对寻址)
  - $ALU\rightarrow AR$
    - 将计算结果输送到$AR$
#### 准备数据
  - 将源地址的数据取出来, **一个机器周期**
  - 从$r_j$中的地址准备数据 
    - $r_i\rightarrow GR$
    - $[r_i]\rightarrow ALU$
    - $+\rightarrow ALU$
    - $ALU\rightarrow DR$
  - 从`AR`中的地址准备数据
    - 等价于读存储器
#### 读/写存储器
  - 一个机器周期
  - $AR\rightarrow AB$
  - **写:** $DR\rightarrow DB$
  - $W/O = 0(read)/1(write)$
  - $M/IO = 1(mem)/0(IO)$
  - **读:** $DB\rightarrow DR$
#### 准备栈指针
- 将$SP$中的地址转移到$AR$中, **一个机器周期**
- $SP\rightarrow ALU$
- $+\rightarrow ALU$
- $ALU\rightarrow AR$
- $SP+1$
  - 这一步可以由硬件完成
#### 入栈
- 将$DR$中存放的数据写入$AR$对应的栈顶地址里
#### 弹栈
- 将$AR$中栈指针对应的数据取出来
## 流水线
### 吞吐率
$$T_p = \frac{n}{T_m}$$
- $n$为指令数
- $T_m$为流水线完成这些指令的总时间
#### 最大吞吐率
$$T_{pmax} = \frac{1}{\hat{\Delta t}}$$
- $\hat{\Delta t}$为**流水线中两个相邻的指令执行完成的间隔时间**
### 效率
$$\eta = \frac{S_p}{S_t}$$
- $S_t$为**时空图**总面积
- $S_p$为 **`CPU`在工作的面积**
### 加速比
$$S = \frac{T_n}{T_m}$$
- $T_n$为顺序执行$n$条指令所需的时间