# 符号表管理
$$变量名:相关信息$$
## 功能
- 建表
- 查表
- 改表
- 删表
## 组织方式
### 线性表
- 按照变量出现的顺序填入
- 查找效率$O(n)$
- 可以对表项排序, 使用二分法查找, $O(\lg n)$
### 二叉树
- 遇到的第一个变量为根节点
- 之后遇到的变量, 大于根节点的放在右子树, 小于的放左子树
- 查找效率$O(\lg n)$

### 哈希表
- 使用哈希函数从名字直接映射到表项
- 采用链表解决地址冲突
- 查找效率$O(1)$

### 杂凑技术
- 构造地址函数/杂凑函数$H$
  - $H$要便于计算
  - $h(x)$均匀分布在$0\sim N-1$, 比如$h(x) = x\% n$
- 杂凑表$\mathcal{H}$为一个$\mathsf{size} = N$的一维数组, 其值为符号表的指针, 最初都为$null$
- 当要插入一个新的符号$x$
  - 首先计算$h(x)$, 然后访问$\mathcal{H}[h(x)]$对应的符号表项
  - 如果对应符号表项为空, 则直接在该表项插入内容
  - 如果已经有值, 那么表项最后一个属性为**下一项指针**, 通过该指针访问下一个表项(即和$x$发生杂凑冲突的表项)
  - 重复上一步, 直到**下一项指针=$null$**, 然后将$x$填入
- 要查询一个符号$y$
  - 计算$h(y)$, 访问$\mathcal{H}[h(y)]$对应的符号表表项
  - 线性查找同一个杂凑函数的变量, 直到找到$y$


## 存储方式
### 单表结构
- Fortran语言, 程序由一个主程序段和若干过程段组成, 所有变量的声明和使用都局限在某一个过程段中, 一旦该过程段结束, 则所有符号清空
- 因此符号表使用普通数组, 在一端保存全局变量, 一端保存过程段中的变量

### 分表结构
- Pascal语言, 程序由一个个嵌套的过程组成, 在嵌套过程中还可以访问主程序声明的变量；但过程外不能访问该过程内部声明的变量
- 因此符号表使用栈, 还是线性地把新出现的变量存入符号表**栈顶**, 无论其出现在哪个过程之中
- 同时维护一个**过程指针**表, 也是一个**栈**, 即表名每个过程的第一个符号在符号表中的位置；
- 同时每个变量有一个特殊的域`previous`, 指向在当前过程中声明的下一个变量在符号表中的位置, 过程中**最后一个变量**的`previous=0`

