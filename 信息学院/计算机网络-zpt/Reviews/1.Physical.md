[TOC]
# 物理层
## 传输特性
### 信道
- 逻辑概念
- 每个双向的通信电路都拥有两个信道
- 如果多个用户共享某个通信电路, 那么每个用户都有一个信道
### 有效带宽
- 信道有**截止频率$f_c$**, $0\sim f_c$的信号振幅不衰减, $f_c$以上的振幅衰减
  - 截止频率由信道本身的物理特性决定
- $0\sim f_c$**是信道的有效带宽**, 又称为**通频带**
- 不同的傅里叶分量在截止频率以上时衰减程度不同, 因此造成信号畸变

### 传输介质
#### 电缆
- 双裸线
  - 两个导线平行放置
- 双绞线
  - 两个绝缘导线扭在一起
  - 无屏蔽双绞线UTP
- 同轴电缆
- 电力线

#### 光纤
- 单模光纤
  - 可以传输多种波长的光, 每种波长只能有一个模式
- 多模光纤
  - 可以传输多种波长的光, 每种波长可以有多个模式
- 传播方式
  - 在**高折射率**的纤芯中进行**全反射**

#### 无线传输
#### 通信卫星

### 传输速率
- 在信道上, 数据以电平信号的形式传播, 一个电平信号对应了一个码元, 一个码元可能蕴含多个比特的信息
  - 比如某个信号分了$8$个电平级, 那么就会对应 $\log(8) = 3\mathrm{bit}$ 的数据
#### 波特率
- **码元**在信道上传输的速率
- 也可以理解为**每秒电平会变化多少次**
#### 奈氏准则
任意信号通过一个带宽为$H$**赫兹**的滤波器, 其**码元传输速率**最大为$2H$**波特($\mathrm{Baud}$)**
- 要将波特率($\mathrm{Baud}$)转化为传输速率($\mathrm{bps}$), 需要考虑信号的编码形式, 若信号有$V$个电平级, 则$$s = \log_2V\implies Speed = 2Hs = 2H\log_2V$$
#### 香农定理
有噪声干扰的有限带宽信道的信息传输速率最大为$$C = H\log_2(1+\frac{S}{N})\mathrm{bit/s}$$
- $H$是信道的带宽$\mathrm{Hz}$
- $S$是信道内所传信号的平均功率, $N$是信道内部的高斯噪声功率, $\frac{S}{N}$称为**信噪比**
- 常规信噪比的单位为分贝$\mathrm{dB}$, 有$$dB = 10\lg\frac{S}{N}$$
  - 即$20\mathrm{dB}$的$\frac{S}{N} = 100$

## 数据编码
- 数据本身有两种形式,
  - 离散的取值为数字数据
  - 连续的取值为模拟数据
- 数据要在信道上发送, 要转化成信号, 信号有两种形式:
  - 离散的取值为**数字信号**
  - 连续的取值为**模拟信号**
- 因此, 有四种$数据\rightarrow 信号$的方式:
### 数字数据编码为数字信号
- 在**基带传输**中使用, 直接传输数字信号
- 实现方式: **编码**

#### 归零编码
#### 不归零NRZ编码
两种不同的电平分别表示$0,1$
- 逢1变化的NRZ
- 逢0变化的NRZ
#### 曼彻斯特码
每一位中间都有一个跳变, 从低到高表示$0$, 从高到低表示$1$
- 中间的跳变既是数据又是时钟
- **相当于一个比特对应两个电平, 因此$B\mathrm{Baud}$的链路仅有$\frac{B}{2}\mathbf{bit/s}$的数据率**
#### 差分曼彻斯特码
  - 每一位中间都有一个跳变, 每一位开始时跳变表示$0$, 不跳变表示$1$
  - 数据和时钟分离

### 数字数据调制为模拟信号
- 在**频带传输**中使用
#### 幅移键控ASK
- 调整信号的振幅来表示0和1
#### 频移键控FSK
- 调整信号的频率来表示0和1
#### 相移键控PSK
- 调整信号的香味来表示0和1
#### 正交振幅调制QAM
- 调整信号的振幅和相位来表示不同的数字信号
- 如果波特率为$B$, 共有$m$个相位和$n$种振幅, 则$$R = B\log_2(mn)$$

### 模拟数据编码为数字信号
- 三个步骤:
  - 采样
    - 对信号进行定期扫描, 将连续信号转化为离散值
    - **奈氏定理**告诉我们, 只有当$f_{sample}\ge 2f_{signal}$时, 才能保证采样后的信号保留了原始模拟信号的信息
  - 量化
    - 对采样到的信号依据一定的准则转化为整数
  - 编码
    - 对得到的数字信号进行编码
- 编码后的信道数据率为$$S = f_{sample}\times B\times \log_2(V)$$
  - $f_{sample}$为采样频率
  - $B$为信道波特率
  - $V$为每个码元的不同电平个数
#### PCM体系
电话频率为$3400\mathrm{Hz}$, 以不少于其两倍的$8000\mathrm{Hz}$采样电话的语音信号, 即取样周期$125\mu s$, 取样结果编码为8位二进制码元, 即$256$个不同电平级, 为了更好地利用信道, 使用时分多路TDM:
##### E1
将$125\mu s$划分为$32$个相等的时隙, 其中$1-15$,$17-31$共30个时隙用来传输数据, 每个时隙分给一个话路, 每个话路都采用$8\mathrm{bit}$编码, 因此总传输率为$$\frac{32*8}{125\mu s} = 2.048\mathrm{Mb/s}$$
##### T1
将$125\mu s$划分为$24$个相等的时隙, 每个时隙传送$7\mathrm{bit}$的数据和$1\mathrm{bit}$的帧同步码, 相当于每一路也是$8\mathrm{bit}$, 最后附加额外的$1\mathrm{bit}$, 数据率为$$\frac{24*8 + 1}{125\mu s} = 1.544\mathrm{Mb/s}$$

#### 码片
每一个比特时间划分为$n$个短的间隔, 称为码片
#### 码片序列
每一个用户(站)被指派一个唯一的$m\mathrm{bit}$二级制数序列, 称为码片序列
- 如果发送$1$, 则发送码片序列
- 如果发送$0$, 则发送码片序列的反码
- **两个不同的站的码片序列彼此正交**
- **同一个站的码片序列和自己的规格化内积是$1$, 和自己反码的规格化内积是$-1$**
#### 发送和接受
- 某站的码片序列为$S$, 要发送二进制位$d_i$, 则输出编码$$d_i = 1 \implies S, d_i = 0 \implies \bar{S}$$
- 接收站接收到$$d_i = Z_i^T\cdot S$$
  - 多用户, 单用户都是一样的
- 原始数据传输率为$b\mathrm{bps}$, 则CDM编码后需要数据传输率为$mb\mathrm{bps}$

## 数据传输
两个节点进行数据传输, 有不同的方法, 涉及到如何将数据打包处理, 以及有怎样的要求:
### 电路交换
- Feature
  - 两个节点在传输前建立一条双方独占的**物理通信路径**, 这个路径可能经过很多个中间节点, 并且**直到连接结束后才被释放**
- 优点
  - 时延小
  - 有序
  - 无冲突
  - 控制简单
- 缺点
  - 建立连接时间长
  - 线路被独占, 信道利用率低
  - 灵活性差
  - 难以规格化
    - 不同类型的终端难以统一
  - **无法提供差错控制**

### 报文交换
- Feature
  - 单位是**报文**
    - 报文携带着目标地址, 源地址等信息
  - 在交换的中间节点采用[存储转发](Term.md#存储转发)的技术
- 优点
  - 不用提前建立连接
  - 动态分配线路
  - 线路更加可靠
  - 利用率高
  - 可以一对多传输
- 缺点
  - 存储转发带来了额外的转发时延
    - 包括校验, 排队, 重新发送等
  - 对报文大小**没有限制**, 要求中间节点有较大的缓存空间

### 分组交换
- Feature
  - 单位是**分组**
    - 限制了每次传送的数据块大小的上限, 将报文划分为小数据块, 再附加上额外的控制信息(地址等), 构成分组
  - 采用存储转发的方式
- 优点
  - 和报文交换一致
  - 加速了传输, **时延小于报文交换**
  - 减小对缓冲区的要求
  - 减少了出错概率和重发数据量
- 缺点
  - 额外的信息量, 降低了传输速率
  - 难以保证分组到达目的节点的顺序

由于分组交换适合突发的数据通信, 在计算机网络中使用的更多, 其可以通过两种方式向端到端的数据传输提供两种服务:
#### 数据报
- 尽力交付, 每个分组独立地选择路由, 到达目的地的顺序可能和发送时不一致
- 网络中包含了冗余路径, 可以应对故障
- 发送方和接收方不独占链路, 资源利用率高

#### 虚电路
- 在数据传输开始前, 建立一个逻辑上将发送方和接受方连接的虚电路, 一经确定就不再改变, 之后传输的分组仅需要在地址位上表名虚电路标识符即可, 而不用存储更多的地址
- 传输结束后断开
- **可靠地数据传输, 可以对端点的数据发送速率加以控制**
- 难以应对虚电路中的链路故障
- **分组的首部不包含目的地址, 仅包含虚电路标识符**
- 与电路交换不同的是, 该虚电路不是专用的, 而是多个虚电路可以共享某一个物理链路
- **传输是否有确认和采取什么样的服务没有关系**

## 重要设备
### 中继器和放大器
- 将输入的信号整形并放大, 然后输出
  - 中继器放大数字信号
  - 放大器放大模拟信号
- 中继器不能存储转发, 其两端连接的网段一定要有相同的传输速率, 并使用同一个协议
- 仅作用于信号, 不能进行纠错

### 集线器
- 本质上是有多个端口的中继器
- 不能处理冲突, 如果多个端口同时受到信息, 那么将会使所有输出信息都无效