[TOC]
# 应用层
在网络的最高层, 应用程序通过一些协议和别的计算机上的应用程序相互沟通, 交换数据。
## DNS系统
总体目的是将域名映射到IP地址, 采用了**客户机/服务器**模型, 并且传输层使用UDP协议, 默认使用53端口
### 域名
分为顶级域名和x级域名, 每一级之间用`.`隔开, `www.ruc.edu.cn`中:
- `cn`是**顶级域名**
- `edu`是**二级域名**
- `ruc`是**三级域名**
- `www`是**四级域名**
  - 标志提供www服务
### 域名服务器
域名到IP的解析在该域名服务器上完成, 一个服务器管辖一个**区**, 该区内各个节点和服务器必须联通, 同时域名服务器和其他的域名服务器之间需要联通, 域名服务器又分为四个等级, 用来表示不同级别的管辖范围:
#### 根域名服务器
最高等级的域名服务器, 全球一个有$13$个(集群), 每个根域名服务器都知道**所有顶级域名服务器的IP地址**
#### 顶级域名服务器
管理在该顶级域名服务器下注册的所有二级域名
#### 权限域名服务器
每一台主机都需要在其对应的权限域名服务器中等级, 表名自己的IP地址
#### 本地域名服务器
最小规模的域名服务器, 将其管辖
### 域名查询
#### 递归查询
- 请求DNS服务的主机向本地域名服务器发出查询
- 本地域名服务器向根域名服务器发出查询
- 根域名服务器向顶级域名服务器发出查询
- 顶级域名服务器向权限域名服务器发出查询
- 权限域名服务器返回查询结果
- 顶级域名服务器返回查询结果
- 根域名服务器返回查询结果
- 本地域名服务器返回查询结果

#### 迭代查询
- 请求DNS服务的主机向本地域名服务器发出查询
- 本地域名服务器向根域名服务器发出查询
- 根服务器**告知**本地域名服务器, 应该向某个顶级域名服务器查询
- 本地域名服务器向该顶级域名服务器发出查询
- 顶级服务器**告知**本地域名服务器, 应该向某个权限域名服务器查询
- 本地域名服务器向该权限域名服务器发出查询
- 本地域名服务器返回查询结果


#### 缓存
- **本机和各级域名服务器上**都会保存对一些域名的查询结果, 方便对相同查询快速返回结果
- 不能存在太长时间, 因为有可能远端的域名变了而没有更新缓存

## 电子邮件
### 步骤
- 发送人调用用户代理撰写编辑要发送的邮件
- 用户代理把邮件用SMTP协议发送给发送方邮件服务器
- 发送方邮件服务器作为SMTP客户和接收方邮件服务器(SMTP服务器)建立TCP连接
- 发送邮件
- 接收方邮件服务器将邮件放入收件人的用户邮箱中
- 收件人的用户代理运行POP3或者IMAP协议读取发送给自己的邮件

#### 用户代理
用户和电子邮件系统的接口, 比如网易邮箱大师

### 邮件格式
#### SMTP
- 无法传送二进制文件
- 只能传送7位的ASCII, 中文就没法传送
- STMP服务器会拒收超过一定长度的邮件

#### MIME
- 在SMTP的基础上加以改进, 附加一些编码规则使其能够处理二进制文件

### 读取邮件
#### POP3
- 接收方的主机运行POP客户程序, 其连接的ISP的邮件服务器运行POP服务器程序

#### IMAP
- 用户通过IMAP协议直接连接到ISP的邮件服务器, 查看邮件的首部；只有当用户需要打开某个邮件时, 其才传到用户的计算机上。


## HTTP
是应用层上, 面相事务的协议, 保证万维网上能够可靠地交换文件, 使用TCP连接

### 步骤
- 发起TCP连接
- 发送HTTP请求报文
- 收到HTTP相应
- 断开TCP连接
### 特性
- **持续连接**
  - 服务器端返回响应后在一段时间内仍然保持连接
- **流水线**
  - 客户不需要等待HTTP的响应报文就可以进行下一个HTTP请求
